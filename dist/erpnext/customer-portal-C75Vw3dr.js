import{u as N,r as l,d as g,x as w,j as e,e as i}from"./customer-portal.js";import{t as C,B as O,C as k,b as D,c as S,a as L,d as B}from"./customer-portal-Dytd1BVN.js";import{B as M}from"./customer-portal-DohqzjMo.js";import{D as E}from"./customer-portal-C7OaD64w.js";import{O as A}from"./customer-portal-BEkLCu7g.js";import{A as F}from"./customer-portal-BXFxuucs.js";import{P as m}from"./customer-portal-DhHtNYSE.js";import{C as T}from"./customer-portal-BR0yYcp_.js";import{B as q}from"./customer-portal-jioiUtxO.js";import"./customer-portal-QpMYTnnK.js";function V(){const[,x]=N(),[p,o]=l.useState(null),[u,c]=l.useState(!1),{language:n}=g(),r=C[n].dashboard,{data:a,isLoading:h,error:t}=w({queryKey:["orders"],queryFn:async()=>(await i("GET","/api/customer/orders")).json(),retry:!1}),j=async s=>{const b=await(await i("GET",`/api/customer/orders/${s.orderNumber}`)).json();o(b),c(!0)},y=()=>{c(!1),o(null)};if(l.useEffect(()=>{t&&console.error("Orders fetch error:",t)},[t]),h)return e.jsx(E,{});if(!a)return null;const f=s=>{switch(s.toLowerCase()){case"delivered":return"bg-green-100 text-green-800";case"in transit":case"processing":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},v=s=>new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD"}).format(parseFloat(s)),d=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--portal-background)"},children:[e.jsx("header",{className:"portal-card border-b sticky top-0 z-40",style:{borderColor:"var(--border)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(O,{variant:"ghost",size:"sm",onClick:()=>x("/dashboard"),className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:r.backToDashboard})]})}),e.jsx("h1",{className:"text-xl font-semibold",style:{color:"var(--portal-text)"},children:r.allOrders}),e.jsx("div",{className:"w-32"})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(k,{className:"portal-card border-portal",children:[e.jsx(D,{children:e.jsxs(S,{style:{color:"var(--portal-text)"},children:[r.orderHistory," (",a.length," ",r.orders,")"]})}),e.jsx(L,{children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(m,{className:"mx-auto h-16 w-16 mb-4",style:{color:"var(--portal-accent)"}}),e.jsx("h3",{className:"text-lg font-medium mb-2",style:{color:"var(--portal-text)"},children:r.noOrdersFound}),e.jsx("p",{style:{color:"var(--portal-accent)"},children:r.noOrdersPlaced})]}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx("div",{className:"border rounded-lg p-6 hover:shadow-md transition-shadow cursor-pointer",style:{borderColor:"var(--border)"},onClick:()=>j(s),children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--portal-primary)"},children:e.jsx(m,{className:"text-white text-lg"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",style:{color:"var(--portal-text)"},children:s.orderNumber}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(T,{className:"h-4 w-4",style:{color:"var(--portal-accent)"}}),e.jsx("span",{className:"text-sm",style:{color:"var(--portal-accent)"},children:d(s.orderDate)})]}),s.deliveryDate&&e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{className:"text-sm",style:{color:"var(--portal-accent)"},children:[r.delivery,": ",d(s.deliveryDate)]})})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(q,{className:"h-4 w-4",style:{color:"var(--portal-secondary)"}}),e.jsx("span",{className:"text-xl font-bold",style:{color:"var(--portal-text)"},children:v(s.amount)})]}),e.jsx(M,{className:f(s.status),children:B(s.status,n)})]})]})},s.id))})})]})}),e.jsx(A,{order:p,isOpen:u,onClose:y})]})}export{V as default};
