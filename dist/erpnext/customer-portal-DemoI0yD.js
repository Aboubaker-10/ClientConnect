import{f as S,u as be,b as ve,r as g,d as we,x as ce,j as e,X as Z,e as _,y as oe}from"./customer-portal.js";import{u as Ce}from"./customer-portal-BG7mLowb.js";import{t as ke,B as p,C,b as ie,c as de,a as k}from"./customer-portal-Dytd1BVN.js";import{I as Se}from"./customer-portal-DdqksWqT.js";import{B as w}from"./customer-portal-DohqzjMo.js";import{S as me}from"./customer-portal-QpMYTnnK.js";import{P as he,D as $e,b as Me,c as Ae,d as Le}from"./customer-portal-DhHtNYSE.js";import{A as Te}from"./customer-portal-BXFxuucs.js";import{S as U,C as xe}from"./customer-portal-DAbcHqru.js";import{B as ze}from"./customer-portal-jioiUtxO.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=S("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=S("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=S("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=S("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=S("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=S("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=S("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);class pe{constructor(){this.ollamaUrl="http://localhost:11434/api/generate",this.model="llama3.2:1b"}async testApiKey(){var l;try{const t=await fetch("http://localhost:11434/api/tags"),c=(l=(await t.json()).models)==null?void 0:l.some(u=>u.name.includes("llama"));return console.log("🧪 Ollama Test:",t.ok?"✅ Connected":"❌ Not running"),t.ok&&!c&&console.log("💡 Install model: ollama pull llama3.2:1b"),t.ok&&c}catch{return console.log("🧪 Ollama Test: ❌ Not installed/running"),console.log("💡 Install: curl -fsSL https://ollama.ai/install.sh | sh"),!1}}async getOllamaAnalysis(l,t){var h;try{console.log("🤖 Ollama analyzing query:",l);const c=`Rate similarity 0-100 for search "${l}" vs these products:
${t.slice(0,8).map((f,i)=>`${i+1}. ${f.substring(0,80)}`).join(`
`)}

Return only numbers separated by commas (example: 85,23,67,12,0,45,78,90):`,u=await fetch(this.ollamaUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,prompt:c,stream:!1,options:{temperature:.1,num_predict:50}})});if(!u.ok)throw new Error(`Ollama error: ${u.status}`);const n=((h=((await u.json()).response||"").match(/\d+/g))==null?void 0:h.map(f=>Math.min(parseInt(f),100)/100))||[];return console.log("✅ Ollama analysis completed, scores:",n.slice(0,5)),n}catch{return console.log("⚠️ Ollama failed, using local AI"),[]}}async search(l,t,h){if(!l.trim())return{results:t.map(x=>({product:x,score:1,matchType:"exact",reason:""})),suggestions:[]};console.log("🤖 Starting Ollama AI search for:",l);const c=[],u=this.isOEMCode(l);try{const x=t.map(i=>`${i.name} ${i.itemCode} ${i.description||""} ${i.category||""} ${i.brand||""}`),y=await this.getOllamaAnalysis(l,x);for(let i=0;i<t.length;i++){const b=t[i],j=[];if(this.exactMatch(l,b)&&j.push({score:1,type:"exact",reason:"Exact match found"}),y[i]&&y[i]>.3&&j.push({score:y[i],type:"semantic",reason:`${Math.round(y[i]*100)}% Ollama AI match`}),u){const N=this.calculateOEMScore(l,b);N>.2&&j.push({score:N,type:"oem_equivalent",reason:`Potential OEM equivalent for ${l}`})}if(j.length===0){const N=this.calculateLocalScore(l,b);N>.2&&j.push({score:N,type:"alternative",reason:"Local similarity match"})}if(j.length>0){const N=j.reduce((M,E)=>E.score>M.score?E:M);c.push({product:b,score:N.score,matchType:N.type,reason:N.reason})}}c.sort((i,b)=>b.score-i.score);const n=c.filter(i=>i.score>.4||i.matchType==="exact"),f=c.filter(i=>i.score<=.4&&i.score>.15);return console.log("✅ Ollama AI Search completed:",{totalResults:n.length,suggestions:f.length}),{results:n.slice(0,50),suggestions:f.slice(0,5),noResultsMessage:n.length===0?u?`No direct match found for OEM code "${l}". Check suggestions below for possible alternatives.`:`No products found matching "${l}". Try different keywords or check suggestions.`:void 0}}catch(x){return console.error("❌ Ollama AI Search error:",x),console.log("🔄 Falling back to local search"),this.fallbackSearch(l,t,h)}}isOEMCode(l){return[/^[A-Z]{2,4}\s?\d{4,8}$/i,/^\d{6,10}$/,/^[A-Z]\d{5,8}$/i,/^[A-Z]{1,3}-?\d{3,6}$/i].some(h=>h.test(l.trim()))}exactMatch(l,t){var c,u,x;const h=l.toLowerCase();return t.name.toLowerCase().includes(h)||t.itemCode.toLowerCase().includes(h)||((c=t.description)==null?void 0:c.toLowerCase().includes(h))||((u=t.category)==null?void 0:u.toLowerCase().includes(h))||((x=t.brand)==null?void 0:x.toLowerCase().includes(h))}calculateOEMScore(l,t){const h=`${t.name} ${t.description||""}`.toLowerCase(),c=l.replace(/\D/g,"");if(c.length>=4){const y=h.match(/\d{4,}/g)||[];for(const n of y)if(n.includes(c.slice(0,4))||c.includes(n.slice(0,4)))return .8}return["oem","original","equivalent","compatible","replacement"].some(y=>h.includes(y))?.4:0}calculateLocalScore(l,t){const h=l.toLowerCase().split(/\s+/),c=`${t.name} ${t.itemCode} ${t.description||""}`.toLowerCase();let u=0;for(const x of h)x.length>2&&c.includes(x)&&u++;return h.length>0?u/h.length:0}fallbackSearch(l,t,h){const c=l.toLowerCase(),u=t.filter(x=>{var y,n,f;return x.name.toLowerCase().includes(c)||x.itemCode.toLowerCase().includes(c)||((y=x.description)==null?void 0:y.toLowerCase().includes(c))||((n=x.category)==null?void 0:n.toLowerCase().includes(c))||((f=x.brand)==null?void 0:f.toLowerCase().includes(c))}).map(x=>({product:x,score:1,matchType:"exact",reason:"Basic text match"}));return{results:u,suggestions:[],noResultsMessage:u.length===0?`No products found for "${l}"`:void 0}}}let I=null;const Fe=async($="")=>{I=new pe;const l=await I.testApiKey();console.log("🧪 Ollama AI Search Test:",l?"✅ Ready":"❌ Setup needed"),l||(console.log("📋 Setup Instructions:"),console.log("1. Install: curl -fsSL https://ollama.ai/install.sh | sh"),console.log("2. Start: ollama serve"),console.log("3. Install model: ollama pull llama3.2:1b"))},Re=async($,l,t)=>(I||(I=new pe),I.search($,l,t));function Ve(){const[,$]=be(),{toast:l}=ve(),[t,h]=g.useState(""),[c,u]=g.useState([]),[x,y]=g.useState(!1),[n,f]=g.useState({categories:[],brands:[]}),[i,b]=g.useState(!1),[j,N]=g.useState(!1),[M,E]=g.useState(!1),[A,Y]=g.useState("grid"),{language:ge}=we(),r=ke[ge].dashboard,{data:P,isLoading:ye,error:F}=ce({queryKey:["products"],queryFn:async()=>(await _("GET","/api/products")).json(),retry:!1}),{data:J}=ce({queryKey:["brands"],queryFn:async()=>(await _("GET","/api/brands")).json(),retry:!1}),G=Ce({mutationFn:async s=>(await _("POST","/api/orders/create",s)).json(),onSuccess:()=>{l({title:r.orderPlacedSuccessfully,description:r.orderSubmittedAndProcessing}),u([]),y(!1),oe.invalidateQueries({queryKey:["dashboard"]}),oe.invalidateQueries({queryKey:["orders"]}),$("/orders")},onError:s=>{l({title:r.orderFailed,description:s.message||r.failedToPlaceOrder,variant:"destructive"})}});g.useEffect(()=>{F&&(console.error("Products fetch error:",F),l({title:r.connectionError,description:r.unableToLoadProductsCheckConnection,variant:"destructive"}))},[F]);const[W,X]=g.useState([]),[R,ee]=g.useState([]),[q,se]=g.useState([]),[fe,ae]=g.useState([]),[te,re]=g.useState([]),[le,ne]=g.useState(void 0),[B,D]=g.useState("idle");g.useEffect(()=>{console.log("🤖 Initializing Ollama AI Search..."),console.log("🔑 Mode: 100% Free Local AI"),Fe()},[]),g.useEffect(()=>{const a=setTimeout(async()=>{if(!P){X([]),ee([]),se([]),ae([]),re([]),ne(void 0),D("idle");return}t.trim()&&D("loading");const d=[...new Set(P.map(m=>m.category).filter(Boolean))],o=J||[],z=P.filter(m=>{const v=n.categories.length===0||n.categories.includes(m.category),Ne=n.brands.length===0||n.brands.includes(m.brand);return parseFloat(m.price)>0&&v&&Ne});try{console.log("🔍 AI Search Query:",t);const m=await Re(t,z,r);console.log("🤖 AI Search Results:",{totalResults:m.results.length,suggestions:m.suggestions.length,hasMessage:!!m.noResultsMessage,sampleResults:m.results.slice(0,3).map(v=>({name:v.product.name,score:v.score,matchType:v.matchType,reason:v.reason}))}),X(m.results.map(v=>v.product)),ee(d),se(o),ae(m.results),re(m.suggestions),ne(m.noResultsMessage),D(t.trim()?"success":"idle")}catch(m){console.error("Search error:",m),D("error")}},t.trim()?500:0);return()=>clearTimeout(a)},[P,t,n,J,r]);const L=s=>{u(a=>a.find(o=>o.id===s.id)?a.map(o=>o.id===s.id?{...o,quantity:o.quantity+1}:o):[...a,{...s,quantity:1}])},H=s=>{u(a=>{const d=a.find(o=>o.id===s);return d&&d.quantity>1?a.map(o=>o.id===s?{...o,quantity:o.quantity-1}:o):a.filter(o=>o.id!==s)})},K=c.reduce((s,a)=>s+parseFloat(a.price)*a.quantity,0),T=s=>`${(typeof s=="string"?parseFloat(s):s).toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2})} MAD`,Q=(s,a)=>{if(!s)return s;let d=s;const o=new RegExp(`^${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(?=[A-Za-z])`,"i");d=d.replace(o,"");const z=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})([A-Za-z])`,"gi");return d=d.replace(z,"$1 $2"),d=d.replace(/([a-zA-Z])(\d{6,})/g,"$1 $2"),d=d.replace(/(\d{6,})([a-zA-Z])/g,"$1 $2"),d=d.replace(/\s+/g," ").trim(),d},je=()=>{if(c.length===0){l({title:r.cartEmpty,description:r.pleaseAddItemsToCart,variant:"destructive"});return}G.mutate({items:c,total:K})};return ye?e.jsx("div",{className:"min-h-screen",style:{backgroundColor:"var(--portal-background)"},children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"h-64 bg-gray-200 rounded animate-pulse"},a))})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--portal-background)"},children:[e.jsx("header",{className:"portal-card border-b sticky top-0 z-50",style:{borderColor:"var(--border)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>$("/dashboard"),className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsx("span",{children:r.backToDashboard})]}),e.jsx("h1",{className:"text-xl font-semibold",style:{color:"var(--portal-text)"},children:r.products})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(p,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",onClick:()=>y(!0),children:[e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"h-5 w-5",style:{color:"var(--portal-accent)"}}),c.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:c.length})]}),e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--portal-text)"},children:r.cart}),K>0&&e.jsx(w,{variant:"secondary",children:T(K)})]})})]})})}),e.jsx("div",{className:"sticky top-16 z-40 bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(p,{variant:i?"default":"outline",size:"sm",onClick:()=>b(!i),className:"flex items-center gap-2 flex-shrink-0",style:i?{backgroundColor:"var(--portal-primary)"}:{},children:[e.jsx(Pe,{className:"h-4 w-4"}),r.filters,(n.categories.length>0||n.brands.length>0)&&e.jsx(w,{variant:i?"secondary":"default",className:"ml-1",children:n.categories.length+n.brands.length})]}),e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4",style:{color:"var(--portal-accent)"}}),e.jsx(Se,{placeholder:`${r.searchProducts} ${B==="success"?"🤖":B==="loading"?"⏳":B==="error"?"⚠️":""}`,value:t,onChange:s=>h(s.target.value),className:"pl-10"}),B==="loading"&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:A==="grid"?"default":"outline",size:"sm",onClick:()=>Y("grid"),className:"flex items-center gap-2",style:A==="grid"?{backgroundColor:"var(--portal-primary)"}:{},children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(p,{variant:A==="list"?"default":"outline",size:"sm",onClick:()=>Y("list"),className:"flex items-center gap-2",style:A==="list"?{backgroundColor:"var(--portal-primary)"}:{},children:e.jsx(Ie,{className:"h-4 w-4"})})]}),(n.categories.length>0||n.brands.length>0)&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.categories.map(s=>e.jsxs(w,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx(p,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent ml-1",onClick:()=>{f(a=>({...a,categories:a.categories.filter(d=>d!==s)}))},children:e.jsx(Z,{className:"h-3 w-3"})})]},s)),n.brands.map(s=>e.jsxs(w,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx(p,{variant:"ghost",size:"sm",className:"h-auto p-0 hover:bg-transparent ml-1",onClick:()=>{f(a=>({...a,brands:a.brands.filter(d=>d!==s)}))},children:e.jsx(Z,{className:"h-3 w-3"})})]},s)),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>f({categories:[],brands:[]}),className:"text-xs px-2 py-1 h-auto text-red-600 hover:text-red-700",children:r.clearAll})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsx("aside",{className:`flex-shrink-0 transition-all duration-300 ease-in-out will-change-auto ${i?"w-80 opacity-100":"w-0 opacity-0 overflow-hidden"}`,children:e.jsx("div",{className:"sticky top-32 h-[calc(100vh-8rem)]",children:e.jsxs(C,{className:"portal-card border-portal shadow-lg h-full flex flex-col",children:[e.jsx(ie,{className:"pb-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{className:"flex items-center gap-2",style:{color:"var(--portal-text)"},children:r.filters}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>b(!1),className:"hover:bg-gray-100 rounded-full w-8 h-8 p-0",children:e.jsx(Z,{className:"h-4 w-4"})})]})}),e.jsxs(k,{className:"space-y-6 flex-1 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-sm",style:{color:"var(--portal-text)"},children:r.categories}),n.categories.length>0&&e.jsx(w,{variant:"secondary",className:"text-xs",children:n.categories.length})]}),e.jsxs("div",{className:"space-y-2",children:[(j?R:R.slice(0,5)).map(s=>{const a=n.categories.includes(s);return e.jsxs("div",{className:"flex items-center group cursor-pointer p-2 rounded hover:bg-gray-50 transition-colors",onClick:()=>{const d=a?n.categories.filter(o=>o!==s):[...n.categories,s];f(o=>({...o,categories:d}))},children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${a?"bg-blue-600 border-blue-600":"border-gray-300 group-hover:border-blue-400"}`,children:a&&e.jsx(xe,{className:"h-3 w-3 text-white"})}),e.jsx("span",{className:`ml-3 text-sm transition-colors ${a?"text-blue-600 font-medium":"text-gray-700 group-hover:text-blue-600"}`,children:s})]},s)}),R.length>5&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>N(!j),className:"w-full text-xs mt-2 text-blue-600 hover:text-blue-700",children:j?r.showLess:`${r.showMore} ${R.length-5}+ ${r.categories}`})]})]}),e.jsx(me,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-sm",style:{color:"var(--portal-text)"},children:r.brands}),n.brands.length>0&&e.jsx(w,{variant:"secondary",className:"text-xs",children:n.brands.length})]}),e.jsxs("div",{className:"space-y-2",children:[(M?q:q.slice(0,5)).map(s=>{const a=n.brands.includes(s);return e.jsxs("div",{className:"flex items-center group cursor-pointer p-2 rounded hover:bg-gray-50 transition-colors",onClick:()=>{const d=a?n.brands.filter(o=>o!==s):[...n.brands,s];f(o=>({...o,brands:d}))},children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${a?"bg-blue-600 border-blue-600":"border-gray-300 group-hover:border-blue-400"}`,children:a&&e.jsx(xe,{className:"h-3 w-3 text-white"})}),e.jsx("span",{className:`ml-3 text-sm transition-colors ${a?"text-blue-600 font-medium":"text-gray-700 group-hover:text-blue-600"}`,children:s})]},s)}),q.length>5&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>E(!M),className:"w-full text-xs mt-2 text-blue-600 hover:text-blue-700",children:M?r.showLess:`${r.showMore} ${q.length-5}+ ${r.brands}`})]})]}),(n.categories.length>0||n.brands.length>0)&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>f({categories:[],brands:[]}),className:"w-full text-red-600 border-red-300 hover:bg-red-50 hover:border-red-400",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),r.clearAllFilters]})})]})]})})}),e.jsx("main",{className:"flex-1",children:e.jsxs("div",{className:"space-y-6",children:[le&&e.jsx(C,{className:"portal-card border-yellow-200 bg-yellow-50",children:e.jsx(k,{className:"pt-4",children:e.jsx("p",{className:"text-sm text-yellow-800",children:le})})}),te.length>0&&e.jsxs(C,{className:"portal-card border-blue-200 bg-blue-50",children:[e.jsx(ie,{className:"pb-3",children:e.jsx(de,{className:"text-sm text-blue-800",children:r.didYouMean})}),e.jsx(k,{className:"space-y-2",children:te.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:s.product.name}),e.jsx("p",{className:"text-xs text-blue-600",children:s.reason})]}),e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>L(s.product),className:"text-blue-600 border-blue-300 hover:bg-blue-100",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),r.add]})]},a))})]}),e.jsx("div",{className:A==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-4",children:F?e.jsx("div",{className:"col-span-full",children:e.jsx(C,{className:"portal-card border-red-200",children:e.jsxs(k,{className:"pt-6 text-center",children:[e.jsx(he,{className:"h-12 w-12 mx-auto mb-4 opacity-50",style:{color:"var(--portal-accent)"}}),e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:"var(--portal-text)"},children:r.unableToLoadProducts}),e.jsx("p",{className:"text-sm",style:{color:"var(--portal-accent)"},children:r.checkYourConnection})]})})}):W.length===0?e.jsx("div",{className:"col-span-full",children:e.jsx(C,{className:"portal-card border-portal",children:e.jsxs(k,{className:"pt-6 text-center",children:[e.jsx(he,{className:"h-12 w-12 mx-auto mb-4 opacity-50",style:{color:"var(--portal-accent)"}}),e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:"var(--portal-text)"},children:r.noProductsFound}),e.jsx("p",{className:"text-sm",style:{color:"var(--portal-accent)"},children:t?r.tryDifferentSearchTermsOrAdjustFilters:r.noProductsAvailable})]})})}):W.map(s=>{var z;const a=((z=c.find(m=>m.id===s.id))==null?void 0:z.quantity)||0,d=fe.find(m=>m.product.id===s.id),o=(d==null?void 0:d.matchType)==="alternative";return A==="grid"?e.jsx(C,{className:`portal-card hover:shadow-lg transition-all duration-200 ${o?"border-blue-300 bg-blue-50":"border-portal"}`,children:e.jsxs(k,{className:"p-0",children:[e.jsxs("div",{className:"aspect-[4/3] w-full overflow-hidden rounded-t-lg bg-gray-50",children:[s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-contain p-3",onError:m=>{m.currentTarget.style.display="none",m.currentTarget.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`w-full h-full flex items-center justify-center ${s.image?"hidden":"flex"}`,style:{color:"var(--portal-accent)"},children:e.jsx(ue,{className:"h-12 w-12 opacity-30"})})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm mb-1 line-clamp-2",style:{color:"var(--portal-text)"},children:Q(s.name,s.itemCode)}),e.jsx("p",{className:"text-xs font-mono text-gray-500",children:s.itemCode}),s.description&&e.jsx("p",{className:"text-xs mt-1 text-gray-600",children:Q(s.description,s.itemCode)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-bold",style:{color:"var(--portal-text)"},children:T(s.price)}),s.category&&e.jsx(w,{variant:"outline",className:"text-xs mt-1",children:s.category})]}),a===0?e.jsxs(p,{onClick:()=>L(s),size:"sm",style:{backgroundColor:"var(--portal-primary)"},className:"text-white hover:opacity-90",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),r.add]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{onClick:()=>H(s.id),size:"sm",variant:"outline",className:"w-8 h-8 p-0",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx("span",{className:"px-3 py-1 bg-gray-100 rounded text-sm font-medium min-w-[2rem] text-center",children:a}),e.jsx(p,{onClick:()=>L(s),size:"sm",variant:"outline",className:"w-8 h-8 p-0",children:e.jsx(O,{className:"h-4 w-4"})})]})]})]})]})},s.id):e.jsx(C,{className:`portal-card hover:shadow-lg transition-all duration-200 ${o?"border-blue-300 bg-blue-50":"border-portal"}`,children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"w-20 h-20 flex-shrink-0 overflow-hidden rounded-lg bg-gray-50",children:[s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-contain p-2",onError:m=>{m.currentTarget.style.display="none",m.currentTarget.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`w-full h-full flex items-center justify-center ${s.image?"hidden":"flex"}`,style:{color:"var(--portal-accent)"},children:e.jsx(ue,{className:"h-8 w-8 opacity-30"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-base mb-1",style:{color:"var(--portal-text)"},children:Q(s.name,s.itemCode)}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mb-1",children:s.itemCode}),s.description&&e.jsx("p",{className:"text-sm text-gray-600",children:Q(s.description,s.itemCode)}),s.category&&e.jsx(w,{variant:"outline",className:"text-xs mt-2",children:s.category})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--portal-text)"},children:T(s.price)})}),a===0?e.jsxs(p,{onClick:()=>L(s),size:"sm",style:{backgroundColor:"var(--portal-primary)"},className:"text-white hover:opacity-90",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),r.add]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{onClick:()=>H(s.id),size:"sm",variant:"outline",className:"w-8 h-8 p-0",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx("span",{className:"px-3 py-1 bg-gray-100 rounded text-sm font-medium min-w-[2rem] text-center",children:a}),e.jsx(p,{onClick:()=>L(s),size:"sm",variant:"outline",className:"w-8 h-8 p-0",children:e.jsx(O,{className:"h-4 w-4"})})]})]})]})})},s.id)})})]})})]})})]}),e.jsx($e,{open:x,onOpenChange:y,children:e.jsxs(Me,{className:"max-w-md",children:[e.jsx(Ae,{children:e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),r.orderSummary]})}),e.jsx("div",{className:"space-y-4",children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"h-8 w-8 mx-auto mb-3 opacity-50",style:{color:"var(--portal-accent)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--portal-accent)"},children:r.yourCartIsEmpty})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:c.map(s=>e.jsxs("div",{className:"flex justify-between items-start space-x-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",style:{color:"var(--portal-text)"},children:s.name}),e.jsxs("p",{className:"text-xs",style:{color:"var(--portal-accent)"},children:[s.quantity," × ",T(s.price)]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(p,{size:"sm",variant:"outline",onClick:()=>H(s.id),className:"h-6 w-6 p-0",children:e.jsx(V,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs w-8 text-center",children:s.quantity}),e.jsx(p,{size:"sm",variant:"outline",onClick:()=>L(s),className:"h-6 w-6 p-0",children:e.jsx(O,{className:"h-3 w-3"})})]})]}),e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--portal-text)"},children:T(parseFloat(s.price)*s.quantity)})]},s.id))}),e.jsx(me,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",style:{color:"var(--portal-text)"},children:r.total}),e.jsx("span",{className:"font-bold text-lg",style:{color:"var(--portal-text)"},children:T(K)})]}),e.jsx(p,{onClick:je,disabled:G.isPending,className:"w-full",style:{backgroundColor:"var(--portal-primary)"},children:G.isPending?r.placingOrder:e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),r.placeOrder]})})]})})]})})]})}export{Ve as default};
